# StateManagerUI

WPF desktop application for monitoring and controlling the WWoW bot system. Provides a visual interface for managing bot characters, viewing state, and configuring behavior.

## Overview

StateManagerUI is a Windows desktop application that:
- **Displays Bot Status**: Real-time view of all connected bots
- **Controls Bot Behavior**: Start/stop/configure individual bots
- **Shows Game State**: Character health, position, targets, etc.
- **Integrates AI**: Chat interface for OpenAI-powered commands

## Architecture

```
StateManagerUI/
??? App.xaml                      # Application entry
??? App.xaml.cs
??? MainWindow.xaml               # Main window layout
??? MainWindow.xaml.cs
??? Views/
?   ??? StateManagerViewModel.cs  # Main view model (MVVM)
??? Handlers/
?   ??? CommandHandler.cs         # ICommand implementation
??? Converters/
?   ??? ValueConverter.cs         # Generic value converter
?   ??? GreaterThanZeroToBooleanConverter.cs
??? BasicLogger.cs                # Simple logging
??? AssemblyInfo.cs
```

## Features

### Bot Status Display

- Character name and level
- Current health/mana percentages
- Position (X, Y, Z coordinates)
- Current activity/state
- Connected/disconnected status

### Control Panel

- Start/Stop individual bots
- Pause/Resume execution
- Change target behavior
- Set grinding paths

### AI Chat Interface

Natural language bot control via Azure OpenAI:

```
User: "Go to Goldshire and grind boars until level 10"
AI: [Configures waypoints and grinding parameters]
```

## MVVM Pattern

### ViewModel

```csharp
public class StateManagerViewModel : INotifyPropertyChanged
{
    public ObservableCollection<BotState> Bots { get; }
    public BotState SelectedBot { get; set; }
    
    public ICommand StartBotCommand { get; }
    public ICommand StopBotCommand { get; }
    public ICommand RefreshCommand { get; }
    
    // Property change notification
    public event PropertyChangedEventHandler PropertyChanged;
}
```

### Command Handler

```csharp
public class CommandHandler : ICommand
{
    private readonly Action<object> _execute;
    private readonly Func<object, bool> _canExecute;
    
    public bool CanExecute(object parameter) => _canExecute?.Invoke(parameter) ?? true;
    public void Execute(object parameter) => _execute(parameter);
}
```

## Dependencies

| Package | Version | Purpose |
|---------|---------|---------|
| Azure.AI.OpenAI | 1.0.0-beta.17 | AI chat integration |

## Project References

- **BotCommLayer**: Protobuf communication with services
- **GameData.Core**: Game data models and interfaces

## Configuration

Settings in `appsettings.json`:

```json
{
  "StateManager": {
    "Host": "localhost",
    "Port": 5001
  },
  "OpenAI": {
    "Endpoint": "https://your-resource.openai.azure.com/",
    "ApiKey": "your-api-key",
    "DeploymentName": "gpt-4"
  }
}
```

## Running

### Requirements

- Windows 10/11 with .NET 8 runtime
- Windows SDK 10.0.22621.0

### Launch

```bash
dotnet run --project UI/StateManagerUI
```

Or run the compiled executable directly.

## Screenshots

*(UI layout description)*

```
???????????????????????????????????????????????????????????
? WWoW State Manager                              [?][?][×]?
???????????????????????????????????????????????????????????
? ??????????????????????? ??????????????????????????????? ?
? ? Bots                ? ? Selected Bot Details        ? ?
? ? ? BotChar1 (Lv 12)  ? ? Name: BotChar1              ? ?
? ? ? BotChar2 (Lv 8)   ? ? Level: 12                   ? ?
? ? ? BotChar3 (Lv 15)  ? ? Health: 850/1200 (70%)      ? ?
? ?                     ? ? Mana: 400/600 (66%)         ? ?
? ?                     ? ? Position: 1234, 5678, 90    ? ?
? ?                     ? ? State: Grinding             ? ?
? ??????????????????????? ? Target: Defias Bandit       ? ?
?                         ??????????????????????????????? ?
? ??????????????????????????????????????????????????????? ?
? ? [Start] [Stop] [Pause] [Configure]                  ? ?
? ??????????????????????????????????????????????????????? ?
? ??????????????????????????????????????????????????????? ?
? ? AI Chat                                             ? ?
? ? > Move to Westfall                                  ? ?
? ? Bot: Setting course for Westfall...                 ? ?
? ? > _                                                 ? ?
? ??????????????????????????????????????????????????????? ?
???????????????????????????????????????????????????????????
```

## Related Documentation

- See `Services/StateManager/README.md` for backend service
- See `ARCHITECTURE.md` for system overview
