### VendorNetworkAgent

Handles all vendor-related operations including buying, selling, and item repairs with enhanced functionality for bulk operations, junk selling, and special item handling.

**Key Features:**
- **Enhanced State Management**: Complete vendor information tracking with item availability, prices, and vendor capabilities
- **Bulk Operations**: Automated bulk buying with stack size calculations and intelligent batching
- **Smart Junk Selling**: Automatic identification and selling of junk items based on quality and name patterns
- **Soulbound Item Handling**: Proper handling and confirmation for soulbound items
- **Advanced Validation**: Comprehensive validation for all vendor operations including item availability, quantities, and player capabilities
- **Quick Operation Workflows**: Complete vendor interaction workflows for common scenarios
- **Comprehensive Vendor Visits**: All-in-one vendor interactions combining repairs, selling, and buying
- **Progress Tracking**: Real-time progress reporting for bulk operations
- **Error Recovery**: Robust error handling with continuation options for bulk operations

**Network Packets:**
- `CMSG_GOSSIP_HELLO` - Opens vendor window
- `CMSG_LIST_INVENTORY` - Requests vendor inventory
- `CMSG_BUY_ITEM` - Purchases an item
- `CMSG_BUY_ITEM_IN_SLOT` - Purchases an item into a specific slot
- `CMSG_SELL_ITEM` - Sells an item
- `CMSG_REPAIR_ITEM` - Repairs an item

**Enhanced Data Models:**
- `VendorInfo` - Complete vendor state and capabilities
- `VendorItem` - Detailed item information with availability and pricing
- `VendorPurchaseData` - Purchase transaction details and results
- `VendorSaleData` - Sale transaction details and results
- `VendorRepairData` - Repair transaction details and results
- `JunkItem` - Items identified for selling as junk
- `SoulboundConfirmation` - Soulbound item confirmation requests
- `BulkVendorOptions` - Configuration for bulk operations

**Example Usage:**
```csharp
var agentFactory = WoWClientFactory.CreateNetworkAgentFactory(worldClient, loggerFactory);

// Basic vendor operations
await agentFactory.VendorAgent.OpenVendorAsync(npcGuid);
await agentFactory.VendorAgent.BuyItemAsync(npcGuid, itemId, quantity: 5);
await agentFactory.VendorAgent.SellItemAsync(npcGuid, bagId, slotId, quantity: 1);
await agentFactory.VendorAgent.RepairAllItemsAsync(npcGuid);

// Enhanced bulk operations
var options = new BulkVendorOptions
{
    MaxOperationTime = TimeSpan.FromMinutes(5),
    DelayBetweenOperations = TimeSpan.FromMilliseconds(250),
    AutoConfirmSoulbound = false,
    ContinueOnError = true
};

// Bulk buy items (handles stack calculations automatically)
await agentFactory.VendorAgent.BuyItemBulkAsync(npcGuid, itemId, totalQuantity: 500, options);

// Sell all junk items (poor/common quality with junk patterns)
var junkOptions = new BulkVendorOptions
{
    MinimumJunkQuality = ItemQuality.Poor,
    MaximumJunkQuality = ItemQuality.Common,
    SkipSpecialItems = true
};
var totalValue = await agentFactory.VendorAgent.SellAllJunkAsync(npcGuid, junkOptions);

// Quick operations (complete workflows)
await agentFactory.VendorAgent.QuickBuyAsync(npcGuid, itemId, quantity: 10);
await agentFactory.VendorAgent.QuickSellAsync(npcGuid, bagId, slotId);
await agentFactory.VendorAgent.QuickRepairAllAsync(npcGuid);
await agentFactory.VendorAgent.QuickSellAllJunkAsync(npcGuid, junkOptions);

// Comprehensive vendor visit
var itemsToBuy = new Dictionary<uint, uint>
{
    { 929, 20 },   // Buy 20 of item 929
    { 2901, 50 }   // Buy 50 of item 2901
};

await agentFactory.VendorAgent.QuickVendorVisitAsync(npcGuid, itemsToBuy, options);

// Advanced validation and information
var canBuy = agentFactory.VendorAgent.CanPurchaseItem(itemId, quantity);
var vendorItem = agentFactory.VendorAgent.FindVendorItem(itemId);
var availableItems = agentFactory.VendorAgent.GetAvailableItems();
var junkItems = await agentFactory.VendorAgent.GetJunkItemsAsync(junkOptions);

// Event handling for vendor operations
agentFactory.VendorAgent.VendorWindowOpened += (vendorInfo) =>
{
    Console.WriteLine($"Vendor opened: {vendorInfo.VendorName} (Can repair: {vendorInfo.CanRepair})");
    Console.WriteLine($"Available items: {vendorInfo.AvailableItems.Count}");
};

agentFactory.VendorAgent.ItemPurchased += (purchaseData) =>
{
    Console.WriteLine($"Purchased: {purchaseData.ItemName} x{purchaseData.Quantity} for {purchaseData.TotalCost} copper");
};

agentFactory.VendorAgent.ItemSold += (saleData) =>
{
    Console.WriteLine($"Sold: {saleData.ItemName} x{saleData.Quantity} for {saleData.TotalValue} copper");
};

agentFactory.VendorAgent.BulkOperationProgress += (operation, current, total) =>
{
    Console.WriteLine($"{operation}: {current}/{total} ({(double)current/total*100:F1}%)");
};

agentFactory.VendorAgent.SoulboundConfirmationRequired += async (confirmation) =>
{
    Console.WriteLine($"Soulbound confirmation required for: {confirmation.ItemName}");
    // Automatically accept or prompt user
    await agentFactory.VendorAgent.RespondToSoulboundConfirmationAsync(confirmation, accept: true);
};

// Close vendor when done
await agentFactory.VendorAgent.CloseVendorAsync();
```

**Advanced Features:**
- **Smart Item Detection**: Automatically identifies junk items based on quality, name patterns, and special item lists
- **Stack Optimization**: Calculates optimal purchase quantities to minimize transactions
- **Soulbound Safety**: Prevents accidental soulbound item operations without confirmation
- **Operation Timeouts**: Configurable timeouts prevent infinite operations
- **Progress Monitoring**: Real-time progress updates for long-running bulk operations
- **Flexible Configuration**: Comprehensive options for customizing vendor behavior
- **Error Recovery**: Continues operations even when individual items fail (configurable)
- **State Persistence**: Maintains vendor state across operations for better efficiency