2025-09-05 21:37:51.519 +01:00 [INF] Checking for config at: C:\Users\WowAdmin\source\repos\sethrhod\BloogBot\Services\CppCodeIntelligenceMCP\appsettings.json
2025-09-05 21:37:51.648 +01:00 [INF] Found config file at: C:\Users\WowAdmin\source\repos\sethrhod\BloogBot\Services\CppCodeIntelligenceMCP\appsettings.json
2025-09-05 21:37:51.651 +01:00 [INF] Configuration built successfully
2025-09-05 21:37:51.652 +01:00 [INF] Registering C++ analysis services...
2025-09-05 21:37:51.881 +01:00 [INF] User profile is available. Using 'C:\Users\WowAdmin\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 21:37:51.899 +01:00 [INF] Starting BloogBot C++ Intelligence MCP Server on http://localhost:5002
2025-09-05 21:37:51.899 +01:00 [INF] MCP SSE endpoint available at: http://localhost:5002/sse
2025-09-05 21:37:52.022 +01:00 [ERR] Hosting failed to start
System.IO.IOException: Failed to bind to address http://127.0.0.1:5002: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted.
 ---> System.Net.Sockets.SocketException (10048): Only one usage of each socket address (protocol/network address/port) is normally permitted.
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(ListenOptions[] listenOptions, AddressBindContext context, Func`2 useHttps, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-09-05 21:37:52.534 +01:00 [FTL] C++ Intelligence MCP Server terminated unexpectedly
System.IO.IOException: Failed to bind to address http://127.0.0.1:5002: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted.
 ---> System.Net.Sockets.SocketException (10048): Only one usage of each socket address (protocol/network address/port) is normally permitted.
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(ListenOptions[] listenOptions, AddressBindContext context, Func`2 useHttps, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Program.<Main>$(String[] args) in C:\Users\WowAdmin\source\repos\sethrhod\BloogBot\Services\CppCodeIntelligenceMCP\Program.cs:line 115
2025-09-05 21:38:09.399 +01:00 [INF] Checking for config at: C:\Users\WowAdmin\source\repos\sethrhod\BloogBot\Services\CppCodeIntelligenceMCP\appsettings.json
2025-09-05 21:38:09.482 +01:00 [INF] Found config file at: C:\Users\WowAdmin\source\repos\sethrhod\BloogBot\Services\CppCodeIntelligenceMCP\appsettings.json
2025-09-05 21:38:09.484 +01:00 [INF] Configuration built successfully
2025-09-05 21:38:09.484 +01:00 [INF] Registering C++ analysis services...
2025-09-05 21:38:09.667 +01:00 [INF] User profile is available. Using 'C:\Users\WowAdmin\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 21:38:09.678 +01:00 [INF] Starting BloogBot C++ Intelligence MCP Server on http://localhost:5002
2025-09-05 21:38:09.678 +01:00 [INF] MCP SSE endpoint available at: http://localhost:5002/sse
2025-09-05 21:38:09.753 +01:00 [ERR] Hosting failed to start
System.IO.IOException: Failed to bind to address http://127.0.0.1:5002: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted.
 ---> System.Net.Sockets.SocketException (10048): Only one usage of each socket address (protocol/network address/port) is normally permitted.
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(ListenOptions[] listenOptions, AddressBindContext context, Func`2 useHttps, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-09-05 21:38:09.778 +01:00 [FTL] C++ Intelligence MCP Server terminated unexpectedly
System.IO.IOException: Failed to bind to address http://127.0.0.1:5002: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted.
 ---> System.Net.Sockets.SocketException (10048): Only one usage of each socket address (protocol/network address/port) is normally permitted.
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(ListenOptions[] listenOptions, AddressBindContext context, Func`2 useHttps, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Program.<Main>$(String[] args) in C:\Users\WowAdmin\source\repos\sethrhod\BloogBot\Services\CppCodeIntelligenceMCP\Program.cs:line 115
2025-09-05 21:38:51.088 +01:00 [INF] Checking for config at: C:\Users\WowAdmin\source\repos\sethrhod\BloogBot\Services\CppCodeIntelligenceMCP\appsettings.json
2025-09-05 21:38:51.226 +01:00 [INF] Found config file at: C:\Users\WowAdmin\source\repos\sethrhod\BloogBot\Services\CppCodeIntelligenceMCP\appsettings.json
2025-09-05 21:38:51.229 +01:00 [INF] Configuration built successfully
2025-09-05 21:38:51.229 +01:00 [INF] Registering C++ analysis services...
2025-09-05 21:38:51.487 +01:00 [INF] User profile is available. Using 'C:\Users\WowAdmin\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 21:38:51.507 +01:00 [INF] Starting BloogBot C++ Intelligence MCP Server on http://localhost:5002
2025-09-05 21:38:51.508 +01:00 [INF] MCP SSE endpoint available at: http://localhost:5002/sse
2025-09-05 21:38:51.620 +01:00 [ERR] Hosting failed to start
System.IO.IOException: Failed to bind to address http://127.0.0.1:5002: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted.
 ---> System.Net.Sockets.SocketException (10048): Only one usage of each socket address (protocol/network address/port) is normally permitted.
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(ListenOptions[] listenOptions, AddressBindContext context, Func`2 useHttps, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-09-05 21:38:51.659 +01:00 [FTL] C++ Intelligence MCP Server terminated unexpectedly
System.IO.IOException: Failed to bind to address http://127.0.0.1:5002: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted.
 ---> System.Net.Sockets.SocketException (10048): Only one usage of each socket address (protocol/network address/port) is normally permitted.
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(ListenOptions[] listenOptions, AddressBindContext context, Func`2 useHttps, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Program.<Main>$(String[] args) in C:\Users\WowAdmin\source\repos\sethrhod\BloogBot\Services\CppCodeIntelligenceMCP\Program.cs:line 115
2025-09-05 21:47:26.756 +01:00 [INF] === C++ Intelligence MCP Server Starting ===
2025-09-05 21:47:26.854 +01:00 [INF] Process ID: 2420
2025-09-05 21:47:26.869 +01:00 [INF] Working Directory: C:\Users\WowAdmin\source\repos\sethrhod\BloogBot\Services\CppCodeIntelligenceMCP
2025-09-05 21:47:26.888 +01:00 [INF] Command Line Args: ["C:\\Users\\WowAdmin\\source\\repos\\sethrhod\\BloogBot\\Services\\CppCodeIntelligenceMCP\\Build\\net8.0\\BloogBot.CppCodeIntelligenceMCP.dll"]
2025-09-05 21:47:27.017 +01:00 [INF] Checking for config at: C:\Users\WowAdmin\source\repos\sethrhod\BloogBot\Services\CppCodeIntelligenceMCP\appsettings.json
2025-09-05 21:47:27.025 +01:00 [INF] Found config file at: C:\Users\WowAdmin\source\repos\sethrhod\BloogBot\Services\CppCodeIntelligenceMCP\appsettings.json
2025-09-05 21:47:27.032 +01:00 [INF] Configuration built successfully
2025-09-05 21:47:27.039 +01:00 [INF] Registering C++ analysis services...
2025-09-05 21:47:27.043 +01:00 [INF] Registering MCP server with HTTP transport...
2025-09-05 21:47:27.056 +01:00 [INF] Building application...
2025-09-05 21:47:27.122 +01:00 [INF] Mapping MCP endpoints...
2025-09-05 21:47:27.274 +01:00 [INF] User profile is available. Using 'C:\Users\WowAdmin\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 21:47:27.304 +01:00 [INF] Starting BloogBot C++ Intelligence MCP Server on http://localhost:5002
2025-09-05 21:47:27.330 +01:00 [INF] MCP SSE endpoint available at: http://localhost:5002/sse
2025-09-05 21:47:27.362 +01:00 [INF] Health check endpoint: http://localhost:5002/health
2025-09-05 21:47:27.371 +01:00 [INF] Server is ready to accept connections...
2025-09-05 21:47:27.388 +01:00 [DBG] Hosting starting
2025-09-05 21:47:27.423 +01:00 [DBG] Reading data from file 'C:\Users\WowAdmin\AppData\Local\ASP.NET\DataProtection-Keys\key-1e6c0df7-8c9b-4be0-a5b4-c9815ca548c2.xml'.
2025-09-05 21:47:27.448 +01:00 [DBG] Found key {1e6c0df7-8c9b-4be0-a5b4-c9815ca548c2}.
2025-09-05 21:47:27.463 +01:00 [DBG] Considering key {1e6c0df7-8c9b-4be0-a5b4-c9815ca548c2} with expiration date 2025-12-03 21:46:37Z as default key.
2025-09-05 21:47:27.480 +01:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-09-05 21:47:27.495 +01:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-09-05 21:47:27.508 +01:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-09-05 21:47:27.523 +01:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-09-05 21:47:27.538 +01:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-09-05 21:47:27.547 +01:00 [DBG] Using key {1e6c0df7-8c9b-4be0-a5b4-c9815ca548c2} as the default key.
2025-09-05 21:47:27.554 +01:00 [DBG] Key ring with default key {1e6c0df7-8c9b-4be0-a5b4-c9815ca548c2} was loaded during application startup.
2025-09-05 21:47:27.602 +01:00 [INF] Now listening on: http://localhost:5002
2025-09-05 21:47:27.611 +01:00 [DBG] Loaded hosting startup assembly BloogBot.CppCodeIntelligenceMCP
2025-09-05 21:47:27.621 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 21:47:27.637 +01:00 [INF] Hosting environment: Production
2025-09-05 21:47:27.645 +01:00 [INF] Content root path: C:\Users\WowAdmin\source\repos\sethrhod\BloogBot\Services\CppCodeIntelligenceMCP
2025-09-05 21:47:27.662 +01:00 [DBG] Hosting started
2025-09-05 21:47:51.088 +01:00 [DBG] Connection id "0HNFCNLTDTA31" accepted.
2025-09-05 21:47:51.104 +01:00 [DBG] Connection id "0HNFCNLTDTA31" started.
2025-09-05 21:47:51.207 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5002/sse - application/json; charset=utf-8 null
2025-09-05 21:47:51.324 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-05 21:47:51.525 +01:00 [DBG] 1 candidate(s) found for the request path '/sse'
2025-09-05 21:47:51.545 +01:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2025-09-05 21:47:51.563 +01:00 [INF] Executing endpoint '405 HTTP Method Not Supported'
2025-09-05 21:47:51.584 +01:00 [INF] Executed endpoint '405 HTTP Method Not Supported'
2025-09-05 21:47:51.608 +01:00 [DBG] Connection id "0HNFCNLTDTA31" completed keep alive response.
2025-09-05 21:47:51.614 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5002/sse - 405 0 null 409.5719ms
2025-09-05 21:47:51.672 +01:00 [DBG] Connection id "0HNFCNLTDTA31", Request id "0HNFCNLTDTA31:00000001": started reading request body.
2025-09-05 21:47:51.693 +01:00 [DBG] Connection id "0HNFCNLTDTA31", Request id "0HNFCNLTDTA31:00000001": done reading request body.
2025-09-05 21:47:51.703 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5002/sse - null null
2025-09-05 21:47:51.729 +01:00 [DBG] 1 candidate(s) found for the request path '/sse'
2025-09-05 21:47:51.735 +01:00 [DBG] Request matched endpoint 'MCP HTTP with SSE | HTTP: GET /sse'
2025-09-05 21:47:51.744 +01:00 [INF] Executing endpoint 'MCP HTTP with SSE | HTTP: GET /sse'
2025-09-05 21:47:51.831 +01:00 [DBG] Connection id "0HNFCNLTDTA32" accepted.
2025-09-05 21:47:51.861 +01:00 [DBG] Connection id "0HNFCNLTDTA32" started.
2025-09-05 21:47:51.898 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5002/message?sessionId=KNCTQ3nT0SYdjuw9EGFrUw - application/json; charset=utf-8 null
2025-09-05 21:47:51.991 +01:00 [DBG] 1 candidate(s) found for the request path '/message'
2025-09-05 21:47:52.017 +01:00 [DBG] Request matched endpoint 'MCP HTTP with SSE | HTTP: POST /message'
2025-09-05 21:47:52.048 +01:00 [INF] Executing endpoint 'MCP HTTP with SSE | HTTP: POST /message'
2025-09-05 21:47:52.086 +01:00 [DBG] Connection id "0HNFCNLTDTA32", Request id "0HNFCNLTDTA32:00000001": started reading request body.
2025-09-05 21:47:52.108 +01:00 [DBG] Connection id "0HNFCNLTDTA32", Request id "0HNFCNLTDTA32:00000001": done reading request body.
2025-09-05 21:47:52.144 +01:00 [INF] Executed endpoint 'MCP HTTP with SSE | HTTP: POST /message'
2025-09-05 21:47:52.150 +01:00 [DBG] Server (BloogBot.CppCodeIntelligenceMCP 1.0.0.0) read JsonRpcRequest message from channel.
2025-09-05 21:47:52.153 +01:00 [DBG] Connection id "0HNFCNLTDTA32" completed keep alive response.
2025-09-05 21:47:52.200 +01:00 [INF] Server (BloogBot.CppCodeIntelligenceMCP 1.0.0.0) method 'initialize' request handler called.
2025-09-05 21:47:52.203 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5002/message?sessionId=KNCTQ3nT0SYdjuw9EGFrUw - 202 null null 304.3389ms
2025-09-05 21:47:52.232 +01:00 [INF] Server (BloogBot.CppCodeIntelligenceMCP 1.0.0.0), Client (VisualStudio 1.0) method 'initialize' request handler completed.
2025-09-05 21:47:52.240 +01:00 [DBG] Server (BloogBot.CppCodeIntelligenceMCP 1.0.0.0), Client (VisualStudio 1.0) sending message.
2025-09-05 21:47:52.271 +01:00 [DBG] Connection id "0HNFCNLTDTA33" accepted.
2025-09-05 21:47:52.277 +01:00 [DBG] Connection id "0HNFCNLTDTA33" started.
2025-09-05 21:47:52.293 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5002/message?sessionId=KNCTQ3nT0SYdjuw9EGFrUw - application/json; charset=utf-8 null
2025-09-05 21:47:52.308 +01:00 [DBG] 1 candidate(s) found for the request path '/message'
2025-09-05 21:47:52.322 +01:00 [DBG] Request matched endpoint 'MCP HTTP with SSE | HTTP: POST /message'
2025-09-05 21:47:52.331 +01:00 [INF] Executing endpoint 'MCP HTTP with SSE | HTTP: POST /message'
2025-09-05 21:47:52.340 +01:00 [DBG] Connection id "0HNFCNLTDTA33", Request id "0HNFCNLTDTA33:00000001": started reading request body.
2025-09-05 21:47:52.359 +01:00 [DBG] Connection id "0HNFCNLTDTA33", Request id "0HNFCNLTDTA33:00000001": done reading request body.
2025-09-05 21:47:52.370 +01:00 [INF] Executed endpoint 'MCP HTTP with SSE | HTTP: POST /message'
2025-09-05 21:47:52.370 +01:00 [DBG] Server (BloogBot.CppCodeIntelligenceMCP 1.0.0.0), Client (VisualStudio 1.0) read JsonRpcNotification message from channel.
2025-09-05 21:47:52.384 +01:00 [DBG] Connection id "0HNFCNLTDTA34" accepted.
2025-09-05 21:47:52.393 +01:00 [DBG] Connection id "0HNFCNLTDTA33" completed keep alive response.
2025-09-05 21:47:52.408 +01:00 [DBG] Connection id "0HNFCNLTDTA34" started.
2025-09-05 21:47:52.415 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5002/message?sessionId=KNCTQ3nT0SYdjuw9EGFrUw - 202 null null 122.4714ms
2025-09-05 21:47:52.423 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5002/message?sessionId=KNCTQ3nT0SYdjuw9EGFrUw - application/json; charset=utf-8 null
2025-09-05 21:47:52.466 +01:00 [DBG] 1 candidate(s) found for the request path '/message'
2025-09-05 21:47:52.476 +01:00 [DBG] Request matched endpoint 'MCP HTTP with SSE | HTTP: POST /message'
2025-09-05 21:47:52.482 +01:00 [INF] Executing endpoint 'MCP HTTP with SSE | HTTP: POST /message'
2025-09-05 21:47:52.487 +01:00 [DBG] Connection id "0HNFCNLTDTA34", Request id "0HNFCNLTDTA34:00000001": started reading request body.
2025-09-05 21:47:52.493 +01:00 [DBG] Connection id "0HNFCNLTDTA34", Request id "0HNFCNLTDTA34:00000001": done reading request body.
2025-09-05 21:47:52.507 +01:00 [INF] Executed endpoint 'MCP HTTP with SSE | HTTP: POST /message'
2025-09-05 21:47:52.507 +01:00 [DBG] Server (BloogBot.CppCodeIntelligenceMCP 1.0.0.0), Client (VisualStudio 1.0) read JsonRpcRequest message from channel.
2025-09-05 21:47:52.513 +01:00 [DBG] Connection id "0HNFCNLTDTA34" completed keep alive response.
2025-09-05 21:47:52.519 +01:00 [INF] Server (BloogBot.CppCodeIntelligenceMCP 1.0.0.0), Client (VisualStudio 1.0) method 'tools/list' request handler called.
2025-09-05 21:47:52.524 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5002/message?sessionId=KNCTQ3nT0SYdjuw9EGFrUw - 202 null null 101.356ms
2025-09-05 21:47:52.571 +01:00 [INF] Server (BloogBot.CppCodeIntelligenceMCP 1.0.0.0), Client (VisualStudio 1.0) method 'tools/list' request handler completed.
2025-09-05 21:47:52.578 +01:00 [DBG] Server (BloogBot.CppCodeIntelligenceMCP 1.0.0.0), Client (VisualStudio 1.0) sending message.
2025-09-05 21:48:51.281 +01:00 [DBG] Connection id "0HNFCNLTDTA32" reset.
2025-09-05 21:48:51.314 +01:00 [DBG] Connection id "0HNFCNLTDTA34" reset.
2025-09-05 21:48:51.474 +01:00 [DBG] Connection id "0HNFCNLTDTA33" reset.
2025-09-05 21:48:51.970 +01:00 [DBG] Connection id "0HNFCNLTDTA32" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-05 21:48:52.532 +01:00 [DBG] Connection id "0HNFCNLTDTA34" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-05 21:48:52.587 +01:00 [DBG] Connection id "0HNFCNLTDTA33" disconnecting.
2025-09-05 21:48:53.484 +01:00 [DBG] Connection id "0HNFCNLTDTA32" disconnecting.
2025-09-05 21:48:53.516 +01:00 [DBG] Connection id "0HNFCNLTDTA34" disconnecting.
2025-09-05 21:48:53.531 +01:00 [DBG] Connection id "0HNFCNLTDTA33" stopped.
2025-09-05 21:48:53.575 +01:00 [DBG] Connection id "0HNFCNLTDTA34" stopped.
2025-09-05 21:48:53.575 +01:00 [DBG] Connection id "0HNFCNLTDTA32" stopped.
2025-09-05 21:48:54.524 +01:00 [DBG] Connection id "0HNFCNLTDTA33" sending FIN because: "The Socket transport's send loop completed gracefully."
